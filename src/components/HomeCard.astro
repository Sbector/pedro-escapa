---
import Wrapper from "./Wrapper.astro";
import RandomImage from "./RandomImage.jsx"; // será un island React/vanilla
import { getImage } from "astro:assets";

// Obtener imágenes
const images = Object.values(
  import.meta.glob("../assets/images/*/*/*.webp", { eager: true })
);

// Optimizar
const optimizedImages = await Promise.all(
  images.map(async (img: any) => {
    const optimized = await getImage({
      src: img.default ?? img.src ?? img,
      format: "webp",
      quality: 85,
      height: 800,
    });

    return {
      src: optimized.src,
      width: optimized.attributes.width,
      height: optimized.attributes.height,
    };
  })
);
---

<Wrapper>
  <RandomImage client:load images={optimizedImages} />
</Wrapper>
