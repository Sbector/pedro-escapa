---
import Layout from "@layouts/Layout.astro";
import HomeCard from "@components/HomeCard.astro";
import { menu } from "@lib/menu";
import { getSubitemData } from "@lib/getSubitemData"; // ← usa la ruta correcta

export async function getStaticPaths() {
  const paths = [];

  for (const item of menu) {
    // Solo incluir elementos visibles
    if (item.visible !== false && item.subitems) {
      for (const sub of item.subitems) {
        // Solo incluir subelementos visibles
        if (sub.visible !== false) {
          paths.push({
            params: {
              categoria: item.id,
              slug: sub.slug,
            },
          });
        }
      }
    }
  }

  return paths;
}

const { categoria, slug } = Astro.params;
const subitemData = getSubitemData(menu, categoria, slug);

if (!subitemData) {
  throw new Error(`No se encontró el subitem: ${categoria}/${slug}`);
}

const { label } = subitemData;
---

<Layout title={`${label} · Pedro Escapa`}>
  <div class="w-full h-full flex flex-col justify-center items-center py-40 px-40">
    <div class="h-full aspect-square bg-amber-300 relative"></div>
    <h1 class="absolute">Aquí el carousel de "<span class="font-bold">{label}</span>"</h1>
  </div>
</Layout>
