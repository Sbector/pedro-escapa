---
import Layout from "@layouts/Layout.astro";
import HomeCard from "@components/HomeCard.astro";
import { menu } from "@lib/menu";
import { getSubitemData } from "@lib/getSubitemData"; // ← usa la ruta correcta
import Carousel from "@components/Carousel.astro";

export async function getStaticPaths() {
  const paths = [];

  for (const item of menu) {
    // Solo incluir elementos visibles
    if (item.visible !== false && item.subitems) {
      for (const sub of item.subitems) {
        // Solo incluir subelementos visibles
        if (sub.visible !== false) {
          paths.push({
            params: {
              categoria: item.id,
              slug: sub.slug,
            },
          });
        }
      }
    }
  }

  return paths;
}

const { categoria, slug } = Astro.params;
const subitemData = getSubitemData(menu, categoria, slug);

if (!subitemData) {
  throw new Error(`No se encontró el subitem: ${categoria}/${slug}`);
}

const { label } = subitemData;
---

<Layout title={`${label} · Pedro Escapa`}>
  <Carousel/>
</Layout>
