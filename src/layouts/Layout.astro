---
import "../styles/global.css";
import { ClientRouter } from "astro:transitions";
import ReactHeader from "@components/Header.jsx";
import Footer from "@components/Footer.astro";
import UnderConstructionModal from "@components/UnderConstructionModal";

interface Props {
	title?: string;
	currentPath?: string;
}

const { title } = Astro.props;

// Construir la ruta actual bas치ndose en los par치metros y la ruta
let currentPath = Astro.url.pathname;

// Para rutas din치micas, construir la ruta desde los par치metros
if (Astro.params.categoria && Astro.params.slug) {
	currentPath = `/${Astro.params.categoria}/${Astro.params.slug}`;
} else if (Astro.params.categoria) {
	currentPath = `/${Astro.params.categoria}`;
}

// Normalizar la ruta (remover trailing slash si existe, excepto para root)
if (currentPath !== "/" && currentPath.endsWith("/")) {
	currentPath = currentPath.slice(0, -1);
}
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<meta name="description" content="Pedro Escapa artista" />
		<title>{title}</title>
		<ClientRouter />
	</head>
	<body class="h-[calc(100dvh-64px)] lg:h-dvh flex flex-col lg:flex-row">
		<ReactHeader client:idle currentPath={currentPath} />
		<main class="flex-1 overflow-y-auto">
			<slot />
			<UnderConstructionModal client:load />
		</main>
		{currentPath == "/" && <Footer />}
	</body>
</html>
